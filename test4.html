<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Controlled Box</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #ecf0f1;
        }

        .square {
            width: 100px;
            height: 100px;
            background-color: #3498db;
            position: absolute;
            transition: top 0.1s ease-in-out; /* Smooth transition for the top square */
        }

        #top-square {
            top: 50%; /* Initial position at the baseline */
        }

        #bottom-square {
            top: 60%; /* Just below the top square */
            background-color: #e74c3c;
        }
    </style>
</head>
<body>

<div id="top-square" class="square"></div>
<div id="bottom-square" class="square"></div>

<script>
    // Access the top square element
    const topSquare = document.getElementById('top-square');
    const bottomSquare = document.getElementById('bottom-square');

    // Set the initial position of the top square
    const baseline = 50; // Baseline at 50% from the top
    const maxHeight = 20; // Maximum height (how far the square can move up)

    // Set up the audio context to measure voice loudness
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    const analyser = audioContext.createAnalyser();
    analyser.fftSize = 256;
    const bufferLength = analyser.frequencyBinCount;
    const dataArray = new Uint8Array(bufferLength);

    // Get access to the user's microphone
    navigator.mediaDevices.getUserMedia({ audio: true })
        .then(stream => {
            const source = audioContext.createMediaStreamSource(stream);
            source.connect(analyser);
            monitorAudio();
        })
        .catch(error => {
            console.error('Error accessing microphone', error);
        });

    // Monitor the loudness of the sound
    function monitorAudio() {
        analyser.getByteFrequencyData(dataArray);

        // Get the average loudness
        let sum = 0;
        for (let i = 0; i < bufferLength; i++) {
            sum += dataArray[i];
        }

        const averageLoudness = sum / bufferLength;
        const normalizedLoudness = averageLoudness / 255; // Normalize to 0 - 1 range

        // Calculate how much to move the square
        const movement = (1 - normalizedLoudness) * maxHeight;

        // Move the square based on the loudness of the voice
        topSquare.style.top = `${baseline - movement}%`; // Move up based on loudness

        // Continue monitoring audio in real-time
        requestAnimationFrame(monitorAudio);
    }

</script>

</body>
</html>
